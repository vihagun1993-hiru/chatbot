<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chatty ‚Äì HR Assistant</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f0f4f8; margin: 0; padding: 0; }
    #welcome { text-align: center; padding: 60px 20px; }
    #chatbox { display: none; max-width: 600px; margin: auto; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .avatar { width: 120px; border-radius: 50%; margin-bottom: 20px; }
    .message { margin: 10px 0; padding: 10px; border-radius: 20px; max-width: 80%; font-size: 15px; line-height: 1.4; }
    .bot { background: #e1ffc7; color: #333; text-align: left; position: relative; }
    .bot::before { content: ""; background-image: url('https://i.imgur.com/7k12EPD.png'); background-size: cover; width: 30px; height: 30px; border-radius: 50%; position: absolute; left: -40px; top: 5px; }
    .user { background: #dcf8c6; color: #000; text-align: right; margin-left: auto; }
    .options button { margin: 5px; padding: 10px 15px; border: none; background: #0077cc; color: white; border-radius: 5px; cursor: pointer; }
    .options button:hover { background: #005fa3; }
    input[type="text"] { width: 100%; padding: 10px; margin-top: 10px; border-radius: 5px; border: 1px solid #ccc; }
    button#startBtn { padding: 12px 25px; font-size: 16px; background: #0077cc; color: white; border: none; border-radius: 8px; cursor: pointer; }
    button#startBtn:hover { background: #005fa3; }
  </style>
</head>
<body>

<div id="welcome">
  <img src="https://media.giphy.com/media/3o6ZtpxSZbQRRnwCKQ/giphy.gif" width="200" alt="Animated dog" />
  <h2>Welcome to Chatty üêæ</h2>
  <p>Hi there! Welcome to <strong>NovaBites Bakery Group</strong> ‚Äî your friendly HR assistant is here to help you with employee engagement and retention. Whether you're looking to grow, feel heard, or stay supported, Chatty is ready to guide you step-by-step.</p>
  <button id="startBtn" onclick="startChat()">Let‚Äôs Chat</button>
</div>

<div id="chatbox">
  <div id="messages"></div>
  <div id="inputArea"></div>
</div>

<script>
  let currentStep = "askID";
  let employeeID = "";
  let branch = "";
  let context = {};

  function startChat() {
    document.getElementById("welcome").style.display = "none";
    document.getElementById("chatbox").style.display = "block";
    showMessage("Hi there! Before we begin, please enter your employee number:", "bot");
    document.getElementById("inputArea").innerHTML = '<input type="text" id="empInput" placeholder="Enter employee number..." onkeydown="handleID(event)" />';
  }

  function handleID(e) {
    if (e.key === "Enter") {
      employeeID = e.target.value.trim();
      if (employeeID) {
        showMessage(employeeID, "user");
        showMessage("Thanks! Would you like help with Engagement or Retention?", "bot");
        showOptions(["Engagement", "Retention"]);
        currentStep = "chooseBranch";
      }
    }
  }

  function showMessage(text, sender = "bot") {
    const msg = document.createElement("div");
    msg.className = `message ${sender}`;
    msg.innerText = text;
    document.getElementById("messages").appendChild(msg);
    msg.scrollIntoView();
  }

  function showOptions(options) {
    const area = document.getElementById("inputArea");
    area.innerHTML = "";
    const container = document.createElement("div");
    container.className = "options";
    options.forEach(opt => {
      const btn = document.createElement("button");
      btn.innerText = opt;
      btn.onclick = () => handleOption(opt);
      container.appendChild(btn);
    });
    area.appendChild(container);
  }

  function handleOption(choice) {
    showMessage(choice, "user");

    if (currentStep === "chooseBranch") {
      branch = choice;
      showMessage(`Thanks! What area of ${branch.toLowerCase()} would you like help with?`, "bot");
      showOptions(branch === "Engagement" ? ["Recognition", "Feedback", "Wellness"] : ["Career Growth", "Stay Interview", "Retention Bonus"]);
      currentStep = "subTopic";
    }

    else if (currentStep === "subTopic") {
      context.topic = choice;
      showMessage(`Got it. What issue are you facing with ${choice}?`, "bot");
      showOptions(["Not available", "Not effective", "Not recognized", "Other"]);
      currentStep = "issueType";
    }

    else if (currentStep === "issueType") {
      context.issue = choice;
      if (choice === "Other") {
        showMessage("Please describe your issue in a few words:", "bot");
        document.getElementById("inputArea").innerHTML = '<input type="text" id="manualInput" placeholder="Type your issue..." onkeydown="handleManualIssue(event)" />';
      } else {
        showMessage("How often does this happen?", "bot");
        showOptions(["Frequently", "Sometimes", "Rarely"]);
        currentStep = "frequency";
      }
    }

    else if (currentStep === "frequency") {
      context.frequency = choice;
      showMessage("Have you shared this with anyone before?", "bot");
      showOptions(["Yes", "No"]);
      currentStep = "sharedBefore";
    }

    else if (currentStep === "sharedBefore") {
      context.shared = choice;
      showMessage("Would you like to request support or suggest an improvement?", "bot");
      showOptions(["Request Support", "Suggest Improvement"]);
      currentStep = "action";
    }

    else if (currentStep === "action") {
      context.action = choice;
      showMessage("Thanks for sharing. Here's what Chatty recommends:", "bot");

      let solution = branch === "Engagement"
        ? `We'll notify HR to review your feedback and consider improvements to ${context.topic}. You can also join the culture committee or use VoiceBox for anonymous input.`
        : `HR will follow up regarding your concern about ${context.topic}. You may also request a stay interview or explore career coaching.`;

      showMessage(solution, "bot");
      showMessage("Do you have any more questions?", "bot");
      showOptions(["Yes", "No"]);
      currentStep = "moreQuestions";
    }

    else if (currentStep === "moreQuestions") {
      if (choice === "Yes") {
        showMessage("Great! Would you like help with Engagement or Retention?", "bot");
        showOptions(["Engagement", "Retention"]);
        currentStep = "chooseBranch";
      } else {
        showMessage("Before you go, how would you rate this experience?", "bot");
        showOptions(["‚≠ê", "‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê‚≠ê", "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê"]);
        currentStep = "rating";
      }
    }

    else if (currentStep === "rating") {
      showMessage(`Thanks for your ${choice} rating, ${employeeID}! Chatty appreciates your feedback and hopes you feel heard and supported. Have a wonderful day üòä`, "bot");
      document.getElementById("inputArea").innerHTML = "";
    }
  }

  function handleManualIssue(e) {
    if (e.key === "Enter") {
      const issue = e.target.value.trim();
      if (issue) {
        showMessage(issue, "user");
        context.issue
